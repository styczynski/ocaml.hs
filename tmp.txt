http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20Usage%20of%20Ocaml-like%20polymorphic%20variant%20types.%0A%20*%29%0A%0Alet%20basic_color_to_int%20%3D%20function%0A%20%20%7C%20%28%60Black%29%20-%3E%200%20%7C%20%28%60Red%29%20%20%20%20%20-%3E%201%20%7C%20%28%60Green%29%20-%3E%202%20%7C%20%28%60Yellow%29%20-%3E%203%0A%20%20%7C%20%28%60Blue%29%20%20-%3E%204%20%7C%20%28%60Magenta%29%20-%3E%205%20%7C%20%28%60Cyan%29%20%20-%3E%206%20%7C%20%28%60White%29%20%20-%3E%207%0A%0Alet%20color_to_int%20%3D%20function%0A%20%20%7C%20%28%60Basic%20%28basic_color%2C%20weight%29%29%20-%3E%0A%20%20%20%20let%20base%20%3D%20%28match%20weight%20with%20%28%60Bold%29%20-%3E%208%20%7C%20%28%60Regular%29%20-%3E%200%29%20in%0A%20%20%20%20base%20+%20basic_color_to_int%20basic_color%0A%20%20%7C%20%28%60RGB%20%28r%2Cg%2Cb%29%29%20-%3E%2016%20+%20b%20+%20g%20*%206%20+%20r%20*%2036%0A%0Alet%20extended_color_to_int%20%3D%20function%0A%20%20%7C%20%28%60RGBA%20%28r%2Cg%2Cb%2Ca%29%29%20-%3E%20256%20+%20a%20+%20b%20*%206%20+%20g%20*%2036%20+%20r%20*%20216%0A%20%20%7C%20%28%28%60Basic%20_%29%20%7C%20%28%60RGB%20_%29%29%20as%20col%20-%3E%20color_to_int%20col%0A%0A%3B%3B%0A%0Acolor_to_int%20%28%28%60Basic%20%28%28%60Black%29%2C%28%60Bold%29%29%29%29
