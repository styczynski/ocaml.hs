---
title: Examples
---

# Examples

This page provides you with preconfigured interpreter instances for basic and advanced demos delivered in /examples/ directory.

## Very basic imperative programming

[Fullscreen playground here](http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20file%20contains%20example%20of%20very%20basic%20imperative%20programming.%0A%20*%20For%20more%20please%20see%20Sudoku.ml%0A%20*%0A%20*%29%0Alet%20counter%20%3D%20ref%200%20in%0Alet%20counterMax%20%3D%203%20in%0Awhile%20%28%21counter%29%20%3C%20counterMax%20do%0A%20%20%20%20printf%20%22Counter%20%3D%20%25d%20%3C%20%25d%5Cn%22%20%28%21counter%29%20counterMax%20%7E%0A%20%20%20%20counter%20%3A%3D%20%21counter+1%0Adone)

<iframe style="border:none; width:100%" src="http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20file%20contains%20example%20of%20very%20basic%20imperative%20programming.%0A%20*%20For%20more%20please%20see%20Sudoku.ml%0A%20*%0A%20*%29%0Alet%20counter%20%3D%20ref%200%20in%0Alet%20counterMax%20%3D%203%20in%0Awhile%20%28%21counter%29%20%3C%20counterMax%20do%0A%20%20%20%20printf%20%22Counter%20%3D%20%25d%20%3C%20%25d%5Cn%22%20%28%21counter%29%20counterMax%20%7E%0A%20%20%20%20counter%20%3A%3D%20%21counter+1%0Adone"></iframe>

## Custom trees operations

[Fullscreen playground here](http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20is%20example%20container%20for%20binary%20trees%20with%20labelled%20nodes.%0A%20*%20It%20contains%20few%20very%20simple%20examples.%0A%20*%29%0A%0A%28*%0A%20*%20Binary%20tree%20that%20has%20%27b%20values%20in%20leafs%20and%20%27a%20values%20in%20node%0A%20*%29%0Atype%20%28%27a%2C%20%27b%29%20Tree%20%3D%20Leaf%20of%20%27b%20%7C%20Node%20of%20%28%28%27a%2C%20%27b%29%20Tree%29%20*%20%27a%20*%20%28%28%27a%2C%20%27b%29%20Tree%29%0A%0A%28*%0A%20*%20Fold%20left%20for%20%27a%20%27a%20trees%0A%20*%20First%20goes%20into%20left%20subtree%2C%20then%20to%20node%20value%20and%20then%20to%20right%20subtree%0A%20*%29%0Alet%20rec%20treeFold%20fn%20t%20acc%20%3D%20match%20t%20with%0A%20%20%20%20%20%7C%20%28Node%20%28t1%2C%20n%2C%20t2%29%29%20-%3E%20treeFold%20fn%20t2%20%28fn%20%28treeFold%20fn%20t1%20acc%29%20n%29%0A%20%20%20%20%20%7C%20%28Leaf%20v%29%20-%3E%20fn%20acc%20v%0A%0A%28*%20Retrieves%20a%20list%20of%20all%20values%20stored%20in%20%27a%20%27a%20tree%20*%29%0Alet%20treeVals%20t%20%3D%20let%20fn%20acc%20x%20%3D%20cons%20x%20acc%20in%20treeFold%20fn%20t%20%5B%5D%0A%0A%28*%20Sum%20over%20all%20tree%20leafs%20*%29%0Alet%20treeSum%20t%20%3D%20treeFold%20%28+%29%20t%200%0A%3B%3B%0A%0A%28*%20Example%20tree%20*%29%0Alet%20tree%20%3D%20%28Node%20%28%28Node%20%28%28Leaf%203%29%2C%202%2C%20%28Node%20%28Node%20%28%28Leaf%201%29%2C4%2C%28Leaf%200%29%29%2C%205%2C%20%28Leaf%2011%29%29%29%29%29%2C%201%2C%20%28Node%20%28%28Leaf%200%29%2C%201%2C%20%28Leaf%202%29%29%29%29%29%20in%0AtreeSum%20tree)

<iframe style="border:none; width:100%" src="http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20is%20example%20container%20for%20binary%20trees%20with%20labelled%20nodes.%0A%20*%20It%20contains%20few%20very%20simple%20examples.%0A%20*%29%0A%0A%28*%0A%20*%20Binary%20tree%20that%20has%20%27b%20values%20in%20leafs%20and%20%27a%20values%20in%20node%0A%20*%29%0Atype%20%28%27a%2C%20%27b%29%20Tree%20%3D%20Leaf%20of%20%27b%20%7C%20Node%20of%20%28%28%27a%2C%20%27b%29%20Tree%29%20*%20%27a%20*%20%28%28%27a%2C%20%27b%29%20Tree%29%0A%0A%28*%0A%20*%20Fold%20left%20for%20%27a%20%27a%20trees%0A%20*%20First%20goes%20into%20left%20subtree%2C%20then%20to%20node%20value%20and%20then%20to%20right%20subtree%0A%20*%29%0Alet%20rec%20treeFold%20fn%20t%20acc%20%3D%20match%20t%20with%0A%20%20%20%20%20%7C%20%28Node%20%28t1%2C%20n%2C%20t2%29%29%20-%3E%20treeFold%20fn%20t2%20%28fn%20%28treeFold%20fn%20t1%20acc%29%20n%29%0A%20%20%20%20%20%7C%20%28Leaf%20v%29%20-%3E%20fn%20acc%20v%0A%0A%28*%20Retrieves%20a%20list%20of%20all%20values%20stored%20in%20%27a%20%27a%20tree%20*%29%0Alet%20treeVals%20t%20%3D%20let%20fn%20acc%20x%20%3D%20cons%20x%20acc%20in%20treeFold%20fn%20t%20%5B%5D%0A%0A%28*%20Sum%20over%20all%20tree%20leafs%20*%29%0Alet%20treeSum%20t%20%3D%20treeFold%20%28+%29%20t%200%0A%3B%3B%0A%0A%28*%20Example%20tree%20*%29%0Alet%20tree%20%3D%20%28Node%20%28%28Node%20%28%28Leaf%203%29%2C%202%2C%20%28Node%20%28Node%20%28%28Leaf%201%29%2C4%2C%28Leaf%200%29%29%2C%205%2C%20%28Leaf%2011%29%29%29%29%29%2C%201%2C%20%28Node%20%28%28Leaf%200%29%2C%201%2C%20%28Leaf%202%29%29%29%29%29%20in%0AtreeSum%20tree"></iframe>

## Basic list operations

[Fullscreen playground here](http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20file%20contains%20basic%20list%20operations.%0A%20*%29%0A%0A%28*%20Reversing%20a%20list%20*%29%0Alet%20rev%20list%20%3D%0A%20%20%20%20let%20rec%20aux%20acc%20%3D%20function%0A%20%20%20%20%20%20%20%20%7C%20%5B%5D%20-%3E%20acc%0A%20%20%20%20%20%20%20%20%7C%20h%3A%3At%20-%3E%20aux%20%28cons%20h%20acc%29%20t%20in%0A%20%20%20%20aux%20%5B%5D%20list%0A%3B%3B%0A%0Arev%20%5B%22a%22%3B%20%22b%22%3B%20%22c%22%5D)

<iframe style="border:none; width:100%" src="http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20file%20contains%20basic%20list%20operations.%0A%20*%29%0A%0A%28*%20Reversing%20a%20list%20*%29%0Alet%20rev%20list%20%3D%0A%20%20%20%20let%20rec%20aux%20acc%20%3D%20function%0A%20%20%20%20%20%20%20%20%7C%20%5B%5D%20-%3E%20acc%0A%20%20%20%20%20%20%20%20%7C%20h%3A%3At%20-%3E%20aux%20%28cons%20h%20acc%29%20t%20in%0A%20%20%20%20aux%20%5B%5D%20list%0A%3B%3B%0A%0Arev%20%5B%22a%22%3B%20%22b%22%3B%20%22c%22%5D"></iframe>

## Higher order functions

[Fullscreen playground here](http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20file%20provides%20some%20higher%20order%20functions%20as%20well%0A%20*%20as%20some%20tasty%20applicative-like%20interface%20for%20veriants.%0A%20*%29%0A%0A%28*%20Map%20list%20with%20index%20*%29%0Alet%20rec%20mapi%20fn%20l%20%3D%0A%20%20%20%20let%20rec%20helper%20fn%20l%20index%20%3D%20match%20l%20with%0A%20%20%20%20%20%20%20%20%7C%20%5B%5D%20-%3E%20%5B%5D%0A%20%20%20%20%20%20%20%20%7C%20%28h%3A%3At%29%20-%3E%20cons%20%28fn%20h%20index%29%20%28helper%20fn%20t%20%28index+1%29%29%0A%20%20%20%20in%20helper%20fn%20l%200%0A%0A%28*%20Map%20list%20without%20index%20*%29%0Alet%20rec%20map%20fn%20l%20%3D%0A%20%20%20%20let%20rec%20mapper%20item%20_%20%3D%20fn%20item%20in%20mapi%20mapper%20l%0A%0A%28*%20Filter%20list%20items%20with%20index%20*%29%0Alet%20rec%20filteri%20fn%20l%20%3D%0A%20%20%20%20let%20rec%20helper%20fn%20l%20index%20%3D%20match%20l%20with%0A%20%20%20%20%20%20%20%20%7C%20%5B%5D%20-%3E%20%5B%5D%0A%20%20%20%20%20%20%20%20%7C%20%28h%3A%3At%29%20-%3E%20let%20rest%20%3D%20helper%20fn%20t%20%28index+1%29%20in%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28fn%20h%20index%29%20then%20cons%20h%20rest%20else%20rest%0A%20%20%20%20in%20helper%20fn%20l%200%0A%0A%28*%20Filter%20list%20items%20without%20index%20*%29%0Alet%20rec%20filter%20fn%20l%20%3D%0A%20%20%20%20let%20rec%20filterer%20item%20_%20%3D%20fn%20item%20in%20filteri%20filterer%20l%0A%0A%28*%20Only%20iterate%20over%20list%2C%20ignore%20result%20*%29%0Alet%20rec%20iteri%20fn%20l%20%3D%20ignore%20%28mapi%20fn%20l%29%0Alet%20rec%20iter%20fn%20l%20%3D%20ignore%20%28map%20fn%20l%29%0A%0A%28*%20Define%20computation%20abstraction%20*%29%0Atype%20%28%27a%2C%27b%29%20Computation%20%3D%20Bad%20of%20%27b%20%7C%20Ok%20of%20%27a%0A%0Alet%20rec%20fmap%20f%20%3D%20function%0A%20%20%20%20%20%7C%20%28Bad%20b%29%20-%3E%20Bad%20b%0A%20%20%20%20%20%7C%20%28Ok%20a%29%20-%3E%20Ok%20%28f%20a%29%0Alet%20return%20v%20%3D%20Ok%20v%0Alet%20pure%20v%20%3D%20Ok%20v%0A%0A%28*%20The%20same%20thing%20as%20with%20Haskell%20applicatives%20*%29%0Alet%20%28%3C*%3E%29%20compFn%20compVal%20%3D%20match%20%28compFn%2C%20compVal%29%20with%0A%20%20%20%20%7C%20%28%28Bad%20b%29%2C%20_%29%20-%3E%20Bad%20b%0A%20%20%20%20%7C%20%28%28Ok%20fn%29%2C%20%28Bad%20b%29%29%20-%3E%20Bad%20b%0A%20%20%20%20%7C%20%28%28Ok%20fn%29%2C%20%28Ok%20v%29%29%20-%3E%20Ok%20%28fn%20v%29%0A%0Alet%20%28%3C%24%3E%29%20fn%20arg%20%3D%20fmap%20fn%20arg%0A%0A%28*%20Define%20lift%3A%20%28%27a%20-%3E%20%27b%20-%3E%20%27c%29%20-%3E%20%28%27a%2C%27d%29%20Computation%20-%3E%20%28%27b%2C%27e%29%20Computation%20-%3E%20%28%27c%2C%27f%29%20Computation%20*%29%0Alet%20liftA2%20f%20a%20b%20%3D%20%28f%20%3C%24%3E%20a%29%20%3C*%3E%20b%0A%0A%3B%3B%0A%0A%28%28+%29%20%3C%24%3E%20Ok%203%29%20%3C*%3E%20Ok%205)

<iframe style="border:none; width:100%" src="http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20file%20provides%20some%20higher%20order%20functions%20as%20well%0A%20*%20as%20some%20tasty%20applicative-like%20interface%20for%20veriants.%0A%20*%29%0A%0A%28*%20Map%20list%20with%20index%20*%29%0Alet%20rec%20mapi%20fn%20l%20%3D%0A%20%20%20%20let%20rec%20helper%20fn%20l%20index%20%3D%20match%20l%20with%0A%20%20%20%20%20%20%20%20%7C%20%5B%5D%20-%3E%20%5B%5D%0A%20%20%20%20%20%20%20%20%7C%20%28h%3A%3At%29%20-%3E%20cons%20%28fn%20h%20index%29%20%28helper%20fn%20t%20%28index+1%29%29%0A%20%20%20%20in%20helper%20fn%20l%200%0A%0A%28*%20Map%20list%20without%20index%20*%29%0Alet%20rec%20map%20fn%20l%20%3D%0A%20%20%20%20let%20rec%20mapper%20item%20_%20%3D%20fn%20item%20in%20mapi%20mapper%20l%0A%0A%28*%20Filter%20list%20items%20with%20index%20*%29%0Alet%20rec%20filteri%20fn%20l%20%3D%0A%20%20%20%20let%20rec%20helper%20fn%20l%20index%20%3D%20match%20l%20with%0A%20%20%20%20%20%20%20%20%7C%20%5B%5D%20-%3E%20%5B%5D%0A%20%20%20%20%20%20%20%20%7C%20%28h%3A%3At%29%20-%3E%20let%20rest%20%3D%20helper%20fn%20t%20%28index+1%29%20in%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20%28fn%20h%20index%29%20then%20cons%20h%20rest%20else%20rest%0A%20%20%20%20in%20helper%20fn%20l%200%0A%0A%28*%20Filter%20list%20items%20without%20index%20*%29%0Alet%20rec%20filter%20fn%20l%20%3D%0A%20%20%20%20let%20rec%20filterer%20item%20_%20%3D%20fn%20item%20in%20filteri%20filterer%20l%0A%0A%28*%20Only%20iterate%20over%20list%2C%20ignore%20result%20*%29%0Alet%20rec%20iteri%20fn%20l%20%3D%20ignore%20%28mapi%20fn%20l%29%0Alet%20rec%20iter%20fn%20l%20%3D%20ignore%20%28map%20fn%20l%29%0A%0A%28*%20Define%20computation%20abstraction%20*%29%0Atype%20%28%27a%2C%27b%29%20Computation%20%3D%20Bad%20of%20%27b%20%7C%20Ok%20of%20%27a%0A%0Alet%20rec%20fmap%20f%20%3D%20function%0A%20%20%20%20%20%7C%20%28Bad%20b%29%20-%3E%20Bad%20b%0A%20%20%20%20%20%7C%20%28Ok%20a%29%20-%3E%20Ok%20%28f%20a%29%0Alet%20return%20v%20%3D%20Ok%20v%0Alet%20pure%20v%20%3D%20Ok%20v%0A%0A%28*%20The%20same%20thing%20as%20with%20Haskell%20applicatives%20*%29%0Alet%20%28%3C*%3E%29%20compFn%20compVal%20%3D%20match%20%28compFn%2C%20compVal%29%20with%0A%20%20%20%20%7C%20%28%28Bad%20b%29%2C%20_%29%20-%3E%20Bad%20b%0A%20%20%20%20%7C%20%28%28Ok%20fn%29%2C%20%28Bad%20b%29%29%20-%3E%20Bad%20b%0A%20%20%20%20%7C%20%28%28Ok%20fn%29%2C%20%28Ok%20v%29%29%20-%3E%20Ok%20%28fn%20v%29%0A%0Alet%20%28%3C%24%3E%29%20fn%20arg%20%3D%20fmap%20fn%20arg%0A%0A%28*%20Define%20lift%3A%20%28%27a%20-%3E%20%27b%20-%3E%20%27c%29%20-%3E%20%28%27a%2C%27d%29%20Computation%20-%3E%20%28%27b%2C%27e%29%20Computation%20-%3E%20%28%27c%2C%27f%29%20Computation%20*%29%0Alet%20liftA2%20f%20a%20b%20%3D%20%28f%20%3C%24%3E%20a%29%20%3C*%3E%20b%0A%0A%3B%3B%0A%0A%28%28+%29%20%3C%24%3E%20Ok%203%29%20%3C*%3E%20Ok%205"></iframe>

## RPN Regex parser

[Fullscreen playground here](http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20file%20provides%20a%20regular%20expressions%20simple%20matching%20library.%0A%20*%20You%20can%20test%20if%20a%20given%20string%20input%20matches%20the%20regular%20expression.%0A%20*%0A%20*%20Due%20to%20simplicity%20regular%20expressions%20are%20specified%20using%20RPN%20notation%3A%0A%20*%0A%20*%20%20%20%20%20%3Ctoken%3E%20%20-%20Push%20string%20literal%20onto%20stack%0A%20*%20%20%20%20%20*%20%20%20%20%20%20%20%20-%20Take%20a%20Kleene%20star%20of%20top%20element%0A%20*%20%20%20%20%20%7C%20%20%20%20%20%20%20%20-%20Take%20union%20of%20two%20top%20elements%0A%20*%20%20%20%20%20+%20%20%20%20%20%20%20%20-%20Concatenate%20two%20top%20elements%0A%20*%20%20%20%20%20null%20%20%20%20%20-%20Null%20token%0A%20*%20%20%20%20%20eps%20%20%20%20%20%20-%20Epsilon%20string%0A%20*%20%20%20%20%20..%20%20%20%20%20%20%20-%20Space%0A%20*%0A%20*%20%20By%20default%20tokens%20are%20spearated%20by%20spaces%20and%20after%20the%20entire%20RPN%20parsing%20all%0A%20*%20%20left%20tokens%20on%20a%20stack%20are%20glued%20together%20using%20concatenation.%0A%20*%20%20So%20expression%3A%0A%20*%20%20%20%20%20%22abc%20def%22%0A%20*%20%20is%20equivalent%20to%0A%20*%20%20%20%20%20%22abc%20def%20+%22%0A%20*%0A%20*%20%20So%20if%20you%20want%20to%20type%20eps%20as%20literal%20and%20to%20epsilon%20string%20just%20use%20+%20operator%3A%0A%20*%20%20%20%20%20%22ep%20s%20+%22%0A%20*%29%0A%0A%28*%20Regular%20expression%20type%20*%29%0Atype%20Regex%20%3D%0A%20%20%20%20%7C%20Null%0A%20%20%20%20%7C%20Empty%0A%20%20%20%20%7C%20Lit%20of%20String%0A%20%20%20%20%7C%20Union%20of%20Regex%20*%20Regex%0A%20%20%20%20%7C%20Concat%20of%20Regex%20*%20Regex%0A%20%20%20%20%7C%20Star%20of%20Regex%0A%0A%28*%20Pretty%20printer%20for%20regular%20expressions%20*%29%0Alet%20rec%20regex_to_str%20r%20%3D%20match%20r%20with%0A%20%20%20%20%7C%20Null%20-%3E%20%22%22%0A%20%20%20%20%7C%20Empty%20-%3E%20%22eps%22%0A%20%20%20%20%7C%20%28Lit%20str%29%20-%3E%20%22%27%22%20%5E%20str%20%5E%20%22%27%22%0A%20%20%20%20%7C%20%28Union%20%28l%2Cr%29%29%20-%3E%20%22%28%28%22%20%5E%20%28regex_to_str%20l%29%20%5E%20%22%7C%22%20%5E%20%28regex_to_str%20r%29%20%5E%20%22%29%29%22%0A%20%20%20%20%7C%20%28Concat%20%28l%2Cr%29%29%20-%3E%20%22%28%22%20%5E%20%28regex_to_str%20l%29%20%5E%20%22%29%28%22%20%5E%20%28regex_to_str%20r%29%20%5E%20%22%29%22%0A%20%20%20%20%7C%20%28Star%20e%29%20-%3E%20%22%28%22%20%5E%20%28regex_to_str%20e%29%20%5E%20%22%29*%22%0A%0A%28*%20Check%20if%20run%20was%20accepting%20one%20*%29%0Alet%20rec%20is_successful%20arg%20%3D%20match%20arg%20with%0A%20%20%20%20%7C%20Null%20-%3E%20false%0A%20%20%20%20%7C%20Empty%20-%3E%20true%0A%20%20%20%20%7C%20%28Lit%20_%29%20-%3E%20false%0A%20%20%20%20%7C%20%28Union%20%28t1%2C%20t2%29%29%20-%3E%20%28is_successful%20t1%29%20%7C%7C%20%28is_successful%20t2%29%0A%20%20%20%20%7C%20%28Concat%20%28t1%2C%20t2%29%29%20-%3E%20%28is_successful%20t1%29%20%26%26%20%28is_successful%20t2%29%0A%20%20%20%20%7C%20%28Star%20t%29%20-%3E%20true%0A%0A%28*%20Simplifies%20regular%20expression%20*%29%0Alet%20rec%20compile_once%20arg%20%3D%20match%20arg%20with%0A%20%20%20%20%7C%20Null%20-%3E%20Null%0A%20%20%20%20%7C%20Empty%20-%3E%20Empty%0A%20%20%20%20%7C%20%28Lit%20c%29%20-%3E%20Lit%20c%0A%20%20%20%20%7C%20%28Union%20%28Null%2C%20t%29%29%20-%3E%20t%0A%20%20%20%20%7C%20%28Union%20%28t%2C%20Null%29%29%20-%3E%20t%0A%20%20%20%20%7C%20%28Union%20%28t%2C%20u%29%29%20-%3E%20if%20t%20%3D%3D%20u%20then%20t%20else%20Union%20%28compile_once%20t%2C%20compile_once%20u%29%0A%20%20%20%20%7C%20%28Concat%20%28Null%2C%20t%29%29%20-%3E%20Null%0A%20%20%20%20%7C%20%28Concat%20%28t%2C%20Null%29%29%20-%3E%20Null%0A%20%20%20%20%7C%20%28Concat%20%28Empty%2C%20t%29%29%20-%3E%20t%0A%20%20%20%20%7C%20%28Concat%20%28t%2C%20Empty%29%29%20-%3E%20t%0A%20%20%20%20%7C%20%28Concat%20%28t%2C%20u%29%29%20-%3E%20Concat%20%28compile_once%20t%2C%20compile_once%20u%29%0A%20%20%20%20%7C%20%28Star%20Null%29%20-%3E%20Null%0A%20%20%20%20%7C%20%28Star%20Empty%29%20-%3E%20Empty%0A%20%20%20%20%7C%20%28Star%20t%29%20-%3E%20Star%20%28compile_once%20t%29%0A%0A%28*%20This%20find%20a%20fixpoint%20*%29%0Alet%20rec%20until_stable%20fn%20arg%20%3D%20if%20%28fn%20arg%29%20%3D%3D%20arg%20then%20arg%20else%20until_stable%20fn%20%28fn%20arg%29%0A%0A%28*%20Compile%20input%20regular%20expression%20*%29%0Alet%20rec%20compile%20%3D%20until_stable%20compile_once%0A%0A%28*%20Perform%20single%20step%20of%20automata%20*%29%0Alet%20rec%20step%20t%20c%20%3D%0A%20%20%20%20match%20t%20with%0A%20%20%20%20%7C%20Null%20-%3E%20Null%0A%20%20%20%20%7C%20Empty%20-%3E%20Null%0A%20%20%20%20%7C%20%28Lit%20c2%29%20-%3E%20if%20c%20%3D%3D%20c2%20then%20Empty%20else%20Null%0A%20%20%20%20%7C%20%28Union%20%28u%2C%20w%29%29%20-%3E%20Union%20%28step%20u%20c%2C%20step%20w%20c%29%0A%20%20%20%20%7C%20%28Concat%20%28u%2C%20w%29%29%20-%3E%0A%20%20%20%20%20%20%20%20if%20is_successful%20u%20then%0A%20%20%20%20%20%20%20%20%20%20Union%20%28Concat%20%28step%20u%20c%2C%20w%29%2C%20step%20w%20c%29%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20Concat%20%28step%20u%20c%2C%20w%29%0A%20%20%20%20%7C%20%28Star%20u%29%20-%3E%20Concat%20%28step%20u%20c%2C%20Star%20u%29%0A%0A%28*%20Compile%20once%20and%20proceed%20*%29%0Alet%20rec%20step_and_compile%20t%20c%20%3D%20compile%20%28step%20t%20c%29%0A%0A%28*%20Run%20automata%20on%20a%20given%20input%20*%29%0Alet%20rec%20run%20t%20s%20%3D%20foldl%20step_and_compile%20t%20s%0A%0A%28*%20Check%20if%20automata%20run%20is%20accepting%20*%29%0Alet%20rec%20accepts%20t%20s%20%3D%20is_successful%20%28run%20t%20s%29%0A%0A%28*%20Helper%20to%20evaluate%20RPN%20binary%20actions%20*%29%0Alet%20binop%20op%20%3D%20function%0A%20%20%7C%20b%3A%3Aa%3A%3Ar%20-%3E%20cons%20%28op%20a%20b%29%20r%0A%20%20%7C%20_%20-%3E%20failwith%20%22invalid%20expression%22%0A%0A%28*%20Helper%20to%20evaluate%20RPN%20unary%20actions%20*%29%0Alet%20uniop%20op%20%3D%20function%0A%20%20%7C%20a%3A%3Ar%20-%3E%20cons%20%28op%20a%29%20r%0A%20%20%7C%20_%20-%3E%20failwith%20%22invalid%20expression%22%0A%0A%28*%20Interpret%20RPN%20tokens%20*%29%0Alet%20interp%20s%20%3D%0A%20%20let%20concatOp%20a%20b%20%3D%20Concat%20%28a%2Cb%29%20in%0A%20%20let%20unionOp%20a%20b%20%3D%20Union%20%28a%2Cb%29%20in%0A%20%20let%20starOp%20a%20%3D%20Star%20a%20in%0A%20%20let%20litOp%20a%20%3D%20Lit%20a%20in%0A%20%20let%20createLit%20a%20%3D%20match%20a%20with%0A%20%20%20%20%7C%20%22null%22%20-%3E%20Null%0A%20%20%20%20%7C%20%22eps%22%20-%3E%20Empty%0A%20%20%20%20%7C%20%22..%22%20-%3E%20Lit%20%22%20%22%0A%20%20%20%20%7C%20str%20-%3E%20foldl%20%28concatOp%29%20Empty%20%28map%20litOp%20%28drop%201%20%28string_split%20%22%22%20str%29%29%29%0A%20%20in%20function%0A%20%20%20%20%7C%20%22*%22%20-%3E%20%22star%22%2C%20%20%20%20%20%20uniop%20%28starOp%29%20s%0A%20%20%20%20%7C%20%22+%22%20-%3E%20%22concat%22%2C%20%20%20%20binop%20%28concatOp%29%20s%0A%20%20%20%20%7C%20%22%7C%22%20-%3E%20%22union%22%2C%20%20%20%20%20binop%20%28unionOp%29%20s%0A%20%20%20%20%7C%20str%20-%3E%20%22push%22%2C%20%28cons%20%28createLit%20str%29%20s%29%0A%0A%28*%20Helper%20function%20to%20run%20interp%20function%20*%29%0Alet%20interp_rpn%20s%20inp%20%3D%0A%20%20let%20%28op%2Cs2%29%20%3D%20interp%20s%20inp%20in%20s2%0A%0A%28*%20Parse%20string%20to%20Regex%20object%20*%29%0Alet%20rpn_eval%20str%20%3D%0A%20%20let%20ss%20%3D%20string_split%20%22%20%22%20str%20in%0A%20%20let%20results%20%3D%20foldl%20interp_rpn%20%5B%5D%20ss%20in%0A%20%20let%20final_fold_fn%20acc%20e%20%3D%20match%20acc%20with%0A%20%20%20%20%7C%20Null%20-%3E%20e%0A%20%20%20%20%7C%20sth%20-%3E%20Concat%20%28e%2Csth%29%0A%20%20in%0A%20%20%20%20foldl%20final_fold_fn%20Null%20results%0A%0Alet%20test_cnt%20%3D%20ref%200%0Alet%20regex_matches%20reg%20str%20%3D%20let%20r%20%3D%20rpn_eval%20reg%20in%0A%20%20%20%20let%20result%20%3D%20accepts%20r%20%28drop%201%20%28string_split%20%22%22%20str%29%29%20in%0A%20%20%20%20%20%20%20%20%28test_cnt%20%3A%3D%20%28%21test_cnt%29%20+%201%29%20%7E%0A%20%20%20%20%20%20%20%20printf%20%22Regex%20test%20%25d%20%7C%20%2530s%20%20%20%7C%20%20%2520s%20%20%20%20%20%7C%20%2510s%5Cn%22%20%28%21test_cnt%29%20%28%22%28%22%5Ereg%5E%22%29%22%29%20%28%22%27%22%5Estr%5E%22%27%22%29%20result%20%7E%0A%20%20%20%20%20%20%20%20result%0A%0A%3B%3B%0A%0Aprintf%20%22%5Cn%20%2560s%20%5Cn%22%20%22%3D%3D%3D%3D%3D%3D%20RPN%20REGEX%20TESTING%20%3D%3D%3D%3D%3D%22%20%7E%0A%0A%28*%20This%20is%20equivalent%20to%20/a%28%20z*%7Cq*%20%29/%20*%29%0Aregex_matches%20%22a%20z%20*%20q%20*%20%7C%22%20%22azzzz%22%20%7E%0A%0A%28*%20This%20is%20equivalent%20to%20/%28ala%7Cbartek%29%20ma%20kota/%20*%29%0Aregex_matches%20%22ala%20bartek%20%7C%20..%20ma%20..%20kota%22%20%22ala%20ma%20kota%22%20%7E%0Aregex_matches%20%22ala%20bartek%20%7C%20..%20ma%20..%20kota%22%20%22bartek%20ma%20kota%22%20%7E%0Aregex_matches%20%22ala%20bartek%20%7C%20..%20ma%20..%20kota%22%20%22ala%20makota%22%20%7E%0A%0A%28*%20This%20is%20equivalent%20to%20/%28a%7Cb%29%28%20a*%20%29z/%20*%29%0Aregex_matches%20%22a%20b%20%7C%20a%20*%20+%20z%22%20%22baaaz%22%20%7E%0Aregex_matches%20%22a%20b%20%7C%20a%20*%20+%20z%22%20%22baaabz%22%20%7E%0A%0Aprintf%20%22%5Cn%22%20%7E%0Aignore%20%22%22)

<iframe style="border:none; width:100%" src="http://styczynski.in/ocaml.hs/parser_index.html?%28*%0A%20*%20This%20file%20provides%20a%20regular%20expressions%20simple%20matching%20library.%0A%20*%20You%20can%20test%20if%20a%20given%20string%20input%20matches%20the%20regular%20expression.%0A%20*%0A%20*%20Due%20to%20simplicity%20regular%20expressions%20are%20specified%20using%20RPN%20notation%3A%0A%20*%0A%20*%20%20%20%20%20%3Ctoken%3E%20%20-%20Push%20string%20literal%20onto%20stack%0A%20*%20%20%20%20%20*%20%20%20%20%20%20%20%20-%20Take%20a%20Kleene%20star%20of%20top%20element%0A%20*%20%20%20%20%20%7C%20%20%20%20%20%20%20%20-%20Take%20union%20of%20two%20top%20elements%0A%20*%20%20%20%20%20+%20%20%20%20%20%20%20%20-%20Concatenate%20two%20top%20elements%0A%20*%20%20%20%20%20null%20%20%20%20%20-%20Null%20token%0A%20*%20%20%20%20%20eps%20%20%20%20%20%20-%20Epsilon%20string%0A%20*%20%20%20%20%20..%20%20%20%20%20%20%20-%20Space%0A%20*%0A%20*%20%20By%20default%20tokens%20are%20spearated%20by%20spaces%20and%20after%20the%20entire%20RPN%20parsing%20all%0A%20*%20%20left%20tokens%20on%20a%20stack%20are%20glued%20together%20using%20concatenation.%0A%20*%20%20So%20expression%3A%0A%20*%20%20%20%20%20%22abc%20def%22%0A%20*%20%20is%20equivalent%20to%0A%20*%20%20%20%20%20%22abc%20def%20+%22%0A%20*%0A%20*%20%20So%20if%20you%20want%20to%20type%20eps%20as%20literal%20and%20to%20epsilon%20string%20just%20use%20+%20operator%3A%0A%20*%20%20%20%20%20%22ep%20s%20+%22%0A%20*%29%0A%0A%28*%20Regular%20expression%20type%20*%29%0Atype%20Regex%20%3D%0A%20%20%20%20%7C%20Null%0A%20%20%20%20%7C%20Empty%0A%20%20%20%20%7C%20Lit%20of%20String%0A%20%20%20%20%7C%20Union%20of%20Regex%20*%20Regex%0A%20%20%20%20%7C%20Concat%20of%20Regex%20*%20Regex%0A%20%20%20%20%7C%20Star%20of%20Regex%0A%0A%28*%20Pretty%20printer%20for%20regular%20expressions%20*%29%0Alet%20rec%20regex_to_str%20r%20%3D%20match%20r%20with%0A%20%20%20%20%7C%20Null%20-%3E%20%22%22%0A%20%20%20%20%7C%20Empty%20-%3E%20%22eps%22%0A%20%20%20%20%7C%20%28Lit%20str%29%20-%3E%20%22%27%22%20%5E%20str%20%5E%20%22%27%22%0A%20%20%20%20%7C%20%28Union%20%28l%2Cr%29%29%20-%3E%20%22%28%28%22%20%5E%20%28regex_to_str%20l%29%20%5E%20%22%7C%22%20%5E%20%28regex_to_str%20r%29%20%5E%20%22%29%29%22%0A%20%20%20%20%7C%20%28Concat%20%28l%2Cr%29%29%20-%3E%20%22%28%22%20%5E%20%28regex_to_str%20l%29%20%5E%20%22%29%28%22%20%5E%20%28regex_to_str%20r%29%20%5E%20%22%29%22%0A%20%20%20%20%7C%20%28Star%20e%29%20-%3E%20%22%28%22%20%5E%20%28regex_to_str%20e%29%20%5E%20%22%29*%22%0A%0A%28*%20Check%20if%20run%20was%20accepting%20one%20*%29%0Alet%20rec%20is_successful%20arg%20%3D%20match%20arg%20with%0A%20%20%20%20%7C%20Null%20-%3E%20false%0A%20%20%20%20%7C%20Empty%20-%3E%20true%0A%20%20%20%20%7C%20%28Lit%20_%29%20-%3E%20false%0A%20%20%20%20%7C%20%28Union%20%28t1%2C%20t2%29%29%20-%3E%20%28is_successful%20t1%29%20%7C%7C%20%28is_successful%20t2%29%0A%20%20%20%20%7C%20%28Concat%20%28t1%2C%20t2%29%29%20-%3E%20%28is_successful%20t1%29%20%26%26%20%28is_successful%20t2%29%0A%20%20%20%20%7C%20%28Star%20t%29%20-%3E%20true%0A%0A%28*%20Simplifies%20regular%20expression%20*%29%0Alet%20rec%20compile_once%20arg%20%3D%20match%20arg%20with%0A%20%20%20%20%7C%20Null%20-%3E%20Null%0A%20%20%20%20%7C%20Empty%20-%3E%20Empty%0A%20%20%20%20%7C%20%28Lit%20c%29%20-%3E%20Lit%20c%0A%20%20%20%20%7C%20%28Union%20%28Null%2C%20t%29%29%20-%3E%20t%0A%20%20%20%20%7C%20%28Union%20%28t%2C%20Null%29%29%20-%3E%20t%0A%20%20%20%20%7C%20%28Union%20%28t%2C%20u%29%29%20-%3E%20if%20t%20%3D%3D%20u%20then%20t%20else%20Union%20%28compile_once%20t%2C%20compile_once%20u%29%0A%20%20%20%20%7C%20%28Concat%20%28Null%2C%20t%29%29%20-%3E%20Null%0A%20%20%20%20%7C%20%28Concat%20%28t%2C%20Null%29%29%20-%3E%20Null%0A%20%20%20%20%7C%20%28Concat%20%28Empty%2C%20t%29%29%20-%3E%20t%0A%20%20%20%20%7C%20%28Concat%20%28t%2C%20Empty%29%29%20-%3E%20t%0A%20%20%20%20%7C%20%28Concat%20%28t%2C%20u%29%29%20-%3E%20Concat%20%28compile_once%20t%2C%20compile_once%20u%29%0A%20%20%20%20%7C%20%28Star%20Null%29%20-%3E%20Null%0A%20%20%20%20%7C%20%28Star%20Empty%29%20-%3E%20Empty%0A%20%20%20%20%7C%20%28Star%20t%29%20-%3E%20Star%20%28compile_once%20t%29%0A%0A%28*%20This%20find%20a%20fixpoint%20*%29%0Alet%20rec%20until_stable%20fn%20arg%20%3D%20if%20%28fn%20arg%29%20%3D%3D%20arg%20then%20arg%20else%20until_stable%20fn%20%28fn%20arg%29%0A%0A%28*%20Compile%20input%20regular%20expression%20*%29%0Alet%20rec%20compile%20%3D%20until_stable%20compile_once%0A%0A%28*%20Perform%20single%20step%20of%20automata%20*%29%0Alet%20rec%20step%20t%20c%20%3D%0A%20%20%20%20match%20t%20with%0A%20%20%20%20%7C%20Null%20-%3E%20Null%0A%20%20%20%20%7C%20Empty%20-%3E%20Null%0A%20%20%20%20%7C%20%28Lit%20c2%29%20-%3E%20if%20c%20%3D%3D%20c2%20then%20Empty%20else%20Null%0A%20%20%20%20%7C%20%28Union%20%28u%2C%20w%29%29%20-%3E%20Union%20%28step%20u%20c%2C%20step%20w%20c%29%0A%20%20%20%20%7C%20%28Concat%20%28u%2C%20w%29%29%20-%3E%0A%20%20%20%20%20%20%20%20if%20is_successful%20u%20then%0A%20%20%20%20%20%20%20%20%20%20Union%20%28Concat%20%28step%20u%20c%2C%20w%29%2C%20step%20w%20c%29%0A%20%20%20%20%20%20%20%20else%0A%20%20%20%20%20%20%20%20%20%20Concat%20%28step%20u%20c%2C%20w%29%0A%20%20%20%20%7C%20%28Star%20u%29%20-%3E%20Concat%20%28step%20u%20c%2C%20Star%20u%29%0A%0A%28*%20Compile%20once%20and%20proceed%20*%29%0Alet%20rec%20step_and_compile%20t%20c%20%3D%20compile%20%28step%20t%20c%29%0A%0A%28*%20Run%20automata%20on%20a%20given%20input%20*%29%0Alet%20rec%20run%20t%20s%20%3D%20foldl%20step_and_compile%20t%20s%0A%0A%28*%20Check%20if%20automata%20run%20is%20accepting%20*%29%0Alet%20rec%20accepts%20t%20s%20%3D%20is_successful%20%28run%20t%20s%29%0A%0A%28*%20Helper%20to%20evaluate%20RPN%20binary%20actions%20*%29%0Alet%20binop%20op%20%3D%20function%0A%20%20%7C%20b%3A%3Aa%3A%3Ar%20-%3E%20cons%20%28op%20a%20b%29%20r%0A%20%20%7C%20_%20-%3E%20failwith%20%22invalid%20expression%22%0A%0A%28*%20Helper%20to%20evaluate%20RPN%20unary%20actions%20*%29%0Alet%20uniop%20op%20%3D%20function%0A%20%20%7C%20a%3A%3Ar%20-%3E%20cons%20%28op%20a%29%20r%0A%20%20%7C%20_%20-%3E%20failwith%20%22invalid%20expression%22%0A%0A%28*%20Interpret%20RPN%20tokens%20*%29%0Alet%20interp%20s%20%3D%0A%20%20let%20concatOp%20a%20b%20%3D%20Concat%20%28a%2Cb%29%20in%0A%20%20let%20unionOp%20a%20b%20%3D%20Union%20%28a%2Cb%29%20in%0A%20%20let%20starOp%20a%20%3D%20Star%20a%20in%0A%20%20let%20litOp%20a%20%3D%20Lit%20a%20in%0A%20%20let%20createLit%20a%20%3D%20match%20a%20with%0A%20%20%20%20%7C%20%22null%22%20-%3E%20Null%0A%20%20%20%20%7C%20%22eps%22%20-%3E%20Empty%0A%20%20%20%20%7C%20%22..%22%20-%3E%20Lit%20%22%20%22%0A%20%20%20%20%7C%20str%20-%3E%20foldl%20%28concatOp%29%20Empty%20%28map%20litOp%20%28drop%201%20%28string_split%20%22%22%20str%29%29%29%0A%20%20in%20function%0A%20%20%20%20%7C%20%22*%22%20-%3E%20%22star%22%2C%20%20%20%20%20%20uniop%20%28starOp%29%20s%0A%20%20%20%20%7C%20%22+%22%20-%3E%20%22concat%22%2C%20%20%20%20binop%20%28concatOp%29%20s%0A%20%20%20%20%7C%20%22%7C%22%20-%3E%20%22union%22%2C%20%20%20%20%20binop%20%28unionOp%29%20s%0A%20%20%20%20%7C%20str%20-%3E%20%22push%22%2C%20%28cons%20%28createLit%20str%29%20s%29%0A%0A%28*%20Helper%20function%20to%20run%20interp%20function%20*%29%0Alet%20interp_rpn%20s%20inp%20%3D%0A%20%20let%20%28op%2Cs2%29%20%3D%20interp%20s%20inp%20in%20s2%0A%0A%28*%20Parse%20string%20to%20Regex%20object%20*%29%0Alet%20rpn_eval%20str%20%3D%0A%20%20let%20ss%20%3D%20string_split%20%22%20%22%20str%20in%0A%20%20let%20results%20%3D%20foldl%20interp_rpn%20%5B%5D%20ss%20in%0A%20%20let%20final_fold_fn%20acc%20e%20%3D%20match%20acc%20with%0A%20%20%20%20%7C%20Null%20-%3E%20e%0A%20%20%20%20%7C%20sth%20-%3E%20Concat%20%28e%2Csth%29%0A%20%20in%0A%20%20%20%20foldl%20final_fold_fn%20Null%20results%0A%0Alet%20test_cnt%20%3D%20ref%200%0Alet%20regex_matches%20reg%20str%20%3D%20let%20r%20%3D%20rpn_eval%20reg%20in%0A%20%20%20%20let%20result%20%3D%20accepts%20r%20%28drop%201%20%28string_split%20%22%22%20str%29%29%20in%0A%20%20%20%20%20%20%20%20%28test_cnt%20%3A%3D%20%28%21test_cnt%29%20+%201%29%20%7E%0A%20%20%20%20%20%20%20%20printf%20%22Regex%20test%20%25d%20%7C%20%2530s%20%20%20%7C%20%20%2520s%20%20%20%20%20%7C%20%2510s%5Cn%22%20%28%21test_cnt%29%20%28%22%28%22%5Ereg%5E%22%29%22%29%20%28%22%27%22%5Estr%5E%22%27%22%29%20result%20%7E%0A%20%20%20%20%20%20%20%20result%0A%0A%3B%3B%0A%0Aprintf%20%22%5Cn%20%2560s%20%5Cn%22%20%22%3D%3D%3D%3D%3D%3D%20RPN%20REGEX%20TESTING%20%3D%3D%3D%3D%3D%22%20%7E%0A%0A%28*%20This%20is%20equivalent%20to%20/a%28%20z*%7Cq*%20%29/%20*%29%0Aregex_matches%20%22a%20z%20*%20q%20*%20%7C%22%20%22azzzz%22%20%7E%0A%0A%28*%20This%20is%20equivalent%20to%20/%28ala%7Cbartek%29%20ma%20kota/%20*%29%0Aregex_matches%20%22ala%20bartek%20%7C%20..%20ma%20..%20kota%22%20%22ala%20ma%20kota%22%20%7E%0Aregex_matches%20%22ala%20bartek%20%7C%20..%20ma%20..%20kota%22%20%22bartek%20ma%20kota%22%20%7E%0Aregex_matches%20%22ala%20bartek%20%7C%20..%20ma%20..%20kota%22%20%22ala%20makota%22%20%7E%0A%0A%28*%20This%20is%20equivalent%20to%20/%28a%7Cb%29%28%20a*%20%29z/%20*%29%0Aregex_matches%20%22a%20b%20%7C%20a%20*%20+%20z%22%20%22baaaz%22%20%7E%0Aregex_matches%20%22a%20b%20%7C%20a%20*%20+%20z%22%20%22baaabz%22%20%7E%0A%0Aprintf%20%22%5Cn%22%20%7E%0Aignore%20%22%22"></iframe>
